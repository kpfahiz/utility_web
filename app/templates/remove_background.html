{% extends "base.html" %}

{% block title %}Remove Background from Image Online | Utility WebApp{% endblock %}

{% block meta_description %}Remove backgrounds from any image instantly for free. Our AI-powered tool provides
professional results with transparency or solid color replacement.{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow-sm mb-5">
            <div class="card-header bg-primary text-white">
                <h1 class="mb-4 h2">üñºÔ∏è Remove Background from Image</h1>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="image" class="form-label">Select Image</label>
                        <input type="file" class="form-control" id="image" name="image" accept="image/*" required>
                        <div class="form-text">Supported formats: JPEG, PNG, WEBP</div>
                    </div>

                    <div class="mb-4">
                        <label for="background_color" class="form-label">Background Color (Optional)</label>
                        <div class="input-group">
                            <input type="color" class="form-control form-control-color" id="background_color"
                                name="background_color" value="#ffffff" title="Choose your color">
                            <div class="input-group-text">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" value="" id="enable_color"
                                        onchange="toggleColorInput()">
                                    <label class="form-check-label" for="enable_color">
                                        Use Solid Color
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-text">Check the box to replace transparency with the selected color.</div>
                    </div>

                    <button type="submit" class="btn btn-primary w-100 py-2">Remove Background</button>
                </form>

                {% if error %}
                <div class="alert alert-danger mt-3">{{ error }}</div>
                {% endif %}

                {% if processed %}
                <div class="mt-4 text-center">
                    <hr>
                    <h5 class="mb-3">Processed Result</h5>
                    <div class="row mt-3">
                        <div class="col-md-6 mb-3">
                            <h6 class="text-muted">Preview</h6>
                            <img src="{{ image_data_uri }}" class="img-fluid border rounded shadow-sm"
                                alt="Background Removed Result" style="max-height: 400px;">
                        </div>
                        <div class="col-md-6 d-flex flex-column justify-content-center">
                            <ul class="list-group mb-3">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Original Size
                                    <span class="badge bg-secondary rounded-pill">{{ "%.2f"|format(original_size_kb) }}
                                        KB</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Processed Size
                                    <span class="badge bg-success rounded-pill">{{ "%.2f"|format(processed_size_kb) }}
                                        KB</span>
                                </li>
                            </ul>

                            <div class="mb-3 text-start">
                                <label for="filename_input" class="form-label">Download Filename</label>
                                <input type="text" class="form-control" id="filename_input" value="{{ download_name }}">
                            </div>

                            <a href="/download-bg-removed/{{ download_name }}"
                                data-original-href="/download-bg-removed/{{ download_name }}" id="download_btn"
                                class="btn btn-success btn-lg shadow-sm">
                                Download High-Res Image
                            </a>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- SEO Content Section -->
        <section class="mt-5 mb-5 pb-5">
            <h2 class="h3 fw-bold mb-4">How to Remove Image Backgrounds Online</h2>
            <p class="text-muted mb-4">Our AI-powered tool makes background removal effortless. Whether you're preparing
                products for an e-commerce store or creating custom social media graphics, we've got you covered.</p>

            <div class="row g-4 mb-5">
                <div class="col-md-4">
                    <h5 class="fw-bold">1. Upload</h5>
                    <p class="small text-muted">Select your image from your device. We support JPG, PNG, and WEBP
                        formats.</p>
                </div>
                <div class="col-md-4">
                    <h5 class="fw-bold">2. Customize</h5>
                    <p class="small text-muted">Choose between a transparent background or pick a solid color for
                        replacement.</p>
                </div>
                <div class="col-md-4">
                    <h5 class="fw-bold">3. Download</h5>
                    <p class="small text-muted">Get your processed, high-quality image instantly with reduced file size.
                    </p>
                </div>
            </div>

            <h3 class="h4 fw-bold mb-4">Frequently Asked Questions</h3>
            <div class="accordion" id="faqAccordion">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                            Is the background removal quality professional?
                        </button>
                    </h2>
                    <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Yes! We use advanced AI models to detect subjects and remove backgrounds with high
                            precision, comparable to manual editing.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq2">
                            Can I replace the background with a specific color?
                        </button>
                    </h2>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Absolutely. You can toggle the "Use Solid Color" option and pick any color using our
                            integrated color selector.
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                            data-bs-target="#faq3">
                            Is my data safe?
                        </button>
                    </h2>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            We value your privacy. Uploaded images are processed and then automatically deleted from our
                            servers after a short period.
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Related Tools Section -->
        <hr class="my-5">
        <section class="mb-5">
            <h3 class="fw-bold mb-4">Discover More Useful Tools</h3>
            <div class="row g-3">
                <div class="col-md-4">
                    <a href="/compress" class="card h-100 text-decoration-none hover-shadow">
                        <div class="card-body text-center p-3">
                            <span class="fs-2 mb-2 d-block">üîß</span>
                            <h6 class="card-title mb-0 text-dark">Image Compression</h6>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="/qr" class="card h-100 text-decoration-none hover-shadow">
                        <div class="card-body text-center p-3">
                            <span class="fs-2 mb-2 d-block">üì±</span>
                            <h6 class="card-title mb-0 text-dark">QR Generator</h6>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="/edit-pdf" class="card h-100 text-decoration-none hover-shadow">
                        <div class="card-body text-center p-3">
                            <span class="fs-2 mb-2 d-block">‚úèÔ∏è</span>
                            <h6 class="card-title mb-0 text-dark">PDF Editor</h6>
                        </div>
                    </a>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- HowTo Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "HowTo",
  "name": "How to Remove Background from Image Online",
  "description": "Learn how to easily remove backgrounds from your images using our AI-powered tool.",
  "step": [
    {
      "@type": "HowToStep",
      "name": "Upload Image",
      "text": "Select your image from your device. We support JPG, PNG, and WEBP formats.",
      "url": "{{ request.url }}"
    },
    {
      "@type": "HowToStep",
      "name": "Choose Background Option",
      "text": "Choose between a transparent background or pick a solid color for replacement using the color picker.",
      "url": "{{ request.url }}"
    },
    {
      "@type": "HowToStep",
      "name": "Download Result",
      "text": "Click the Remove Background button and then download your processed, high-quality image instantly.",
      "url": "{{ request.url }}"
    }
  ],
  "totalTime": "PT30S"
}
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const colorInput = document.getElementById('background_color');
        const checkbox = document.getElementById('enable_color');

        if (colorInput && checkbox) {
            // Initial state
            colorInput.disabled = !checkbox.checked;

            // Toggle logic
            window.toggleColorInput = function () {
                colorInput.disabled = !checkbox.checked;
            };
        }

        // Rename logic
        const filenameInput = document.getElementById('filename_input');
        const downloadBtn = document.getElementById('download_btn');

        if (filenameInput && downloadBtn) {
            const originalHref = downloadBtn.getAttribute('data-original-href');

            filenameInput.addEventListener('input', function () {
                const newName = filenameInput.value.trim();
                if (newName) {
                    const separator = originalHref.includes('?') ? '&' : '?';
                    downloadBtn.setAttribute('href', `${originalHref}${separator}name=${encodeURIComponent(newName)}`);
                } else {
                    downloadBtn.setAttribute('href', originalHref);
                }
            });
        }
    });
</script>
{% endblock %}